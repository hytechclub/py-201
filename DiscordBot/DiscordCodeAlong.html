
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Discord Code-Along Â· Python 201</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="DiscordChallenges.html" />
    
    
    <link rel="prev" href="StudentDesc.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Python 201
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://hylandtechclub.com/ReplitSetup">
            
                    
                    Repl Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../HelloPython/StudentDesc.html">
            
                <a href="../HelloPython/StudentDesc.html">
            
                    
                    Week 1 - Hello Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../HelloPython/TurtleCodeAlong.html">
            
                <a href="../HelloPython/TurtleCodeAlong.html">
            
                    
                    Turtle Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../HelloPython/TurtleChallenges.html">
            
                <a href="../HelloPython/TurtleChallenges.html">
            
                    
                    Turtle Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../BasicProgramming/StudentDesc.html">
            
                <a href="../BasicProgramming/StudentDesc.html">
            
                    
                    Week 2 - Basic Programming
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../BasicProgramming/RPSCodeAlong.html">
            
                <a href="../BasicProgramming/RPSCodeAlong.html">
            
                    
                    Rock Paper Scissors Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../BasicProgramming/RPSChallenges.html">
            
                <a href="../BasicProgramming/RPSChallenges.html">
            
                    
                    Rock Paper Scissors Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Collections/StudentDesc.html">
            
                <a href="../Collections/StudentDesc.html">
            
                    
                    Week 3 - Collections
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Collections/PlaylistWarmup.html">
            
                <a href="../Collections/PlaylistWarmup.html">
            
                    
                    Playlist Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../Collections/ScoreSortCodeAlong.html">
            
                <a href="../Collections/ScoreSortCodeAlong.html">
            
                    
                    Sort By Score Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../Collections/ScoreSortChallenges.html">
            
                <a href="../Collections/ScoreSortChallenges.html">
            
                    
                    Sort By Score Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="StudentDesc.html">
            
                <a href="StudentDesc.html">
            
                    
                    Week 4 - Discord Bot
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.6.1" data-path="DiscordCodeAlong.html">
            
                <a href="DiscordCodeAlong.html">
            
                    
                    Discord Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="DiscordChallenges.html">
            
                <a href="DiscordChallenges.html">
            
                    
                    Discord Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../WebScraping/StudentDesc.html">
            
                <a href="../WebScraping/StudentDesc.html">
            
                    
                    Week 5 - Web Scraping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../WebScraping/HtmlReviewWarmup.html">
            
                <a href="../WebScraping/HtmlReviewWarmup.html">
            
                    
                    HTML Review Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../WebScraping/InfoFinderCodeAlong.html">
            
                <a href="../WebScraping/InfoFinderCodeAlong.html">
            
                    
                    Info Finder Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../WebScraping/InfoFinderChallenges.html">
            
                <a href="../WebScraping/InfoFinderChallenges.html">
            
                    
                    Info Finder Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../MidSemesterReview/StudentDesc.html">
            
                <a href="../MidSemesterReview/StudentDesc.html">
            
                    
                    Week 6 - Review + Check-Ins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../MidSemesterReview/Challenges.html">
            
                <a href="../MidSemesterReview/Challenges.html">
            
                    
                    Challenges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../MidSemesterReview/Library.html">
            
                <a href="../MidSemesterReview/Library.html">
            
                    
                    Library
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../Flask/StudentDesc.html">
            
                <a href="../Flask/StudentDesc.html">
            
                    
                    Week 7 - Flask Web Server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../Flask/FlaskBasics.html">
            
                <a href="../Flask/FlaskBasics.html">
            
                    
                    Flask Basics Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../Flask/FlaskCodeAlong.html">
            
                <a href="../Flask/FlaskCodeAlong.html">
            
                    
                    Random Joke Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../Flask/FlaskChallenges.html">
            
                <a href="../Flask/FlaskChallenges.html">
            
                    
                    Flask Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../PyGame/StudentDesc.html">
            
                <a href="../PyGame/StudentDesc.html">
            
                    
                    Week 8 - Pygame
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../PyGame/PygameWarmup.html">
            
                <a href="../PyGame/PygameWarmup.html">
            
                    
                    Pygame Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../PyGame/TopDownCodeAlong.html">
            
                <a href="../PyGame/TopDownCodeAlong.html">
            
                    
                    Top-down Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../PyGame/PygameChallenges.html">
            
                <a href="../PyGame/PygameChallenges.html">
            
                    
                    Pygame Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../Database/StudentDesc.html">
            
                <a href="../Database/StudentDesc.html">
            
                    
                    Week 9 - Database
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../Database/RestaurantReviewCodeAlong.html">
            
                <a href="../Database/RestaurantReviewCodeAlong.html">
            
                    
                    Restaurant Review Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../Database/DatabaseChallenges.html">
            
                <a href="../Database/DatabaseChallenges.html">
            
                    
                    Database Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../FinalProject/StudentDesc.html">
            
                <a href="../FinalProject/StudentDesc.html">
            
                    
                    Week 10 - Final Project
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Discord Code-Along</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="discord-chat-bot">Discord Chat Bot</h1>
<p>In this activity, create a Discord chat bot that can respond to messages in a Discord server. How the chat bot responds and what it says is for you to decide! The chat bot could respond to common phrases, or respond to commands with useful features like rolling dice, posting pictures, or acting as a calculator.</p>
<h2 id="part-1-running-the-starter-bot">Part 1: Running the Starter Bot</h2>
<p>The most involved part of this activity will be getting the basic bot connected to Discord. This does not involve changing any code - it&apos;s all setup. Follow these instructions to join the sandbox server, create the bot application, and hooking up the code.</p>
<h3 id="joining-the-sandbox-server">Joining the Sandbox Server</h3>
<p><a href="https://discord.gg/ev9t26vu5W" target="_blank">Click here to join the Sandbox Server.</a></p>
<p>You will need a Discord account to complete this activity. If you do not have one, you can follow <a href="https://hylandtechclub.com/DiscordUse#setup" target="_blank">these instructions</a> after clicking the invite link above.</p>
<h3 id="creating-the-bot-application-in-discord">Creating the Bot Application in Discord</h3>
<p>After you&apos;ve joined the server, you need to create the <strong>Application</strong>. You can create many types of Discord applications, including bots!</p>
<ol>
<li>Go to your <a href="https://discord.com/developers/applications" target="_blank">Discord Developer Portal</a><ul>
<li>Note: you must be logged into Discord in the browser for this</li>
</ul>
</li>
<li>Click the &quot;New Application&quot; button in the upper right<br> <img src="Assets/NewApplicationButton.png" alt=""></li>
<li>Enter a unique name for your bot (e.g., &quot;Robot Bot&quot;) and click the &quot;Create&quot; button<br> <img src="Assets/CreateAppName.png" alt=""></li>
<li>From the menu on the left, click the &quot;Bot&quot; option</li>
<li>On that page, click the &quot;Add Bot&quot; button on the right<br> <img src="Assets/AddBot.png" alt=""></li>
<li>When the pop-up appears, click the &quot;Yes, do it!&quot; button
 <img src="Assets/AddBotYesDoIt.png" alt=""></li>
</ol>
<video width="100%" height="450px" controls>
  <source src="Assets/DoIt.mp4" type="video/mp4">
</video>

<p>Now you have yourself a shiny new bot application!</p>
<h3 id="configuring-the-bot">Configuring the Bot</h3>
<p>The next step is to setup the bot, and prepare it to join the server.</p>
<ol>
<li>On the &quot;Bot&quot; page, scroll down to the &quot;Privileged Gateway Intents&quot; section</li>
<li>Toggle the &quot;MESSAGE CONTENT INTENT&quot; option<br> <img src="Assets/PrivilegedIntent.png" alt=""></li>
<li>From the menu on the left, click the &quot;OAuth2&quot; option</li>
<li>In the sub-menu on the left, click the &quot;URL Generator&quot; option</li>
<li>There, check the &quot;bot&quot; checkbox under &quot;SCOPES&quot;<br> <img src="Assets/UrlGenBot.png" alt=""></li>
<li>In the &quot;BOT PERMISSIONS&quot; sections, select the necessary checkboxes:<ul>
<li>Read Messages/View Channels</li>
<li>Send Messages</li>
<li>Read Message History</li>
</ul>
</li>
<li>Click the &quot;Copy&quot; button on the right under &quot;GENERATED URL&quot;<br> <img src="Assets/PermissionsUrl.png" alt=""></li>
</ol>
<p>This copied link will allow you to invite your bot to any server where you have the &quot;Manage Server&quot; permission!</p>
<h3 id="inviting-the-bot-to-the-sandbox-server">Inviting the Bot to the Sandbox Server</h3>
<p>Everyone who joins the <strong>Python 201 Sandbox</strong> server should have &quot;Manage Server&quot; permissions, which means everyone should be able to add bots! Follow these steps to add yours.</p>
<ol>
<li>Paste the copied link into your browser</li>
<li>In the &quot;ADD TO SERVER&quot; dropdown, select <strong>Python 201 Sandbox</strong></li>
<li>Click the &quot;Continue&quot; button<br> <img src="Assets/ContinueInviteBot.png" alt=""></li>
<li>On the next screen, click the &quot;Authorize&quot; button<br> <img src="Assets/AuthorizeBot.png" alt=""></li>
<li>Verify humanity if needed</li>
<li>Close the tab</li>
</ol>
<p>Now, your bot should be in the server! Make sure you see them appear.</p>
<h3 id="copying-the-token">Copying the Token</h3>
<p>You&apos;ll need one last thing from Discord - your bot&apos;s token. Every bot has a secret token that allows developers to log in and write code that uses the application. You can reset and copy the token in the developer portal.</p>
<ol>
<li>Return to the <a href="https://discord.com/developers/applications" target="_blank">Discord Developer Portal</a></li>
<li>Click on your bot application under &quot;My Applications&quot;<br> <img src="Assets/MyApplications.png" alt=""></li>
<li>From the menu on the left, click the &quot;Bot&quot; option</li>
<li>On that page, click the &quot;Reset Token&quot; button under &quot;Build-a-Bot&quot;<br> <img src="Assets/ResetToken.png" alt=""></li>
<li>When the pop-up appears, click the &quot;Yes, do it!&quot; button<br> <img src="Assets/YesResetBotToken.png" alt=""></li>
<li>When the token appears, click the &quot;Copy&quot; button under it<br> <img src="Assets/CopyToken.png" alt=""></li>
</ol>
<p>With that token, you will be able to connect to Discord with your bot!</p>
<h3 id="updating-and-running-the-repl">Updating and Running the Repl</h3>
<p>There is a starter Repl project with some basic bot code. Add your secret token and run the bot!</p>
<ol>
<li>Open and fork the <a href="https://replit.com/@HylandOutreach/DiscordBot#main.py" target="_blank">starter Repl project</a></li>
<li>On the left, in the &quot;Tools&quot; section, click the &quot;Secrets&quot; button<br> <img src="Assets/ReplitSecrets.png" alt=""></li>
<li>If this is your first time using Secrets, click the &quot;Got it&quot; button<br> <img src="Assets/SecretsGotIt.png" alt=""></li>
<li>On the next screen, enter &quot;DISCORD_BOT_SECRET&quot; in the &quot;key&quot; field</li>
<li>Paste your copied secret token in the &quot;value&quot; field</li>
<li>Click the &quot;Add new secret&quot; button<br> <img src="Assets/AddSecret.png" alt=""></li>
<li>Click the &quot;Run&quot; button to bring the bot to life</li>
</ol>
<p>In the console, a <code>Logged in as:</code> message should appear - that means the bot is online!</p>
<h3 id="testing-the-bot">Testing the Bot</h3>
<p>With the bot up and running, you should be able to test it out!</p>
<ol>
<li>Go to Discord</li>
<li>Verify that your bot appears as &quot;ONLINE&quot; in the server</li>
<li>Go into your specific channel</li>
<li>Post any message</li>
<li>Go back to the Repl project, and make sure the message author and content appeared in the console</li>
<li>Go back to Discord, and send &quot;ping&quot;</li>
<li>Verify that the bot responds with &quot;pong&quot;</li>
</ol>
<p>That&apos;s just about all the bot can do at the moment, but it lays the groundwork for a much more powerful application.</p>
<h2 id="part-2-reviewing-the-starter-code">Part 2: Reviewing the Starter Code</h2>
<p>Before attempting to update the bot, it may be helpful to understand what the code is already doing.</p>
<h3 id="imports">Imports</h3>
<p>The first couple lines use <code>import</code> to pull in some helpful libraries:</p>
<ul>
<li>The <a href="https://discordpy.readthedocs.io/en/stable/" target="_blank"><code>discord</code></a> library wraps the Discord API and allows code to interact with Discord</li>
<li>The <a href="https://docs.python.org/3/library/os.html" target="_blank"><code>os</code></a> library allows code to interact with the operating system</li>
</ul>
<pre><code class="lang-py"><span class="hljs-keyword">import</span> discord
<span class="hljs-keyword">import</span> os
</code></pre>
<h3 id="intents">Intents</h3>
<p>The next couple lines create the &quot;intents&quot; object for the bot - this object tells the Discord API what the bot should be able to do. In this case, the bot needs the ability to access the content of messages, so the <code>message_content</code> property is set to <code>True</code> - everything else is kept default.</p>
<pre><code class="lang-py">intents = discord.Intents.default()
intents.message_content = <span class="hljs-keyword">True</span>
</code></pre>
<h3 id="client-creation">Client Creation</h3>
<p>The next line uses the <code>discord</code> library to create the client - this is the intermediary between the code and the API. It passes in the <code>intents</code> object so it knows what it should be able to do.</p>
<pre><code class="lang-py">client = discord.Client(intents=intents)
</code></pre>
<h3 id="onready-function"><code>on_ready</code> Function</h3>
<p>The next few lines define the <code>on_ready</code> function, which is wrapped by the <code>@client.event</code> decorator. The decorator tells the <code>client</code> object that this function should be used when responding to an event - specifically, the <code>on_ready</code> event.</p>
<p>The function is marked <code>async</code> because it must be able to be run dynamically based on the events sent from the Discord API.</p>
<p>When the client has successfully logged into the server, this function prints a message with the bot&apos;s username.</p>
<pre><code class="lang-py"><span class="hljs-meta">@client.event</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_ready</span><span class="hljs-params">()</span>:</span>
  print(f<span class="hljs-string">&quot;Logged in as: {client.user}&quot;</span>)
</code></pre>
<h3 id="onmessage-function"><code>on_message</code> Function</h3>
<p>The next several lines define the <code>on_message</code> function. It has the <code>@client.event</code> decorator so that it can run when a new message appears in the server. It takes in a <code>message</code> object as a parameter, and then responds appropriately based on the message <code>author</code>, <code>channel</code>, and <code>content</code>.</p>
<p>It is marked <code>async</code> so that it can respond to multiple messages without freezing up.</p>
<p>The function does a few different things.</p>
<pre><code class="lang-py"><span class="hljs-meta">@client.event</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_message</span><span class="hljs-params">(message)</span>:</span>
</code></pre>
<h4 id="author-check">Author Check</h4>
<p>The function will immediately return if the new message is coming from a bot.</p>
<pre><code class="lang-py"><span class="hljs-keyword">if</span> message.author.bot:
  <span class="hljs-keyword">return</span>
</code></pre>
<h4 id="print">Print</h4>
<p>If the message is not from a bot, the function will print out the content of the message, along with the author, using an f-string.</p>
<pre><code class="lang-py">print(f<span class="hljs-string">&quot;Message from {message.author}: {message.content}&quot;</span>)
</code></pre>
<h4 id="prompt-response">Prompt Response</h4>
<p>Finally, the fun part - the function will check the content of the message. For now, it only responds if <code>message.content</code> is <code>&quot;ping&quot;</code>. In that case, it uses <code>message.channel.send</code> to send <code>&quot;pong&quot;</code> back in the same channel.</p>
<p>The <code>await</code> keyword is used in front of the <code>send</code> function because it needs to go through the internet to reach the Discord API - that can take a while.</p>
<pre><code class="lang-py"><span class="hljs-keyword">if</span> message.content == <span class="hljs-string">&quot;ping&quot;</span>:
  <span class="hljs-keyword">await</span> message.channel.send(<span class="hljs-string">&quot;pong&quot;</span>)
</code></pre>
<h3 id="secret-token-retrieval">Secret Token Retrieval</h3>
<p>After the <code>on_message</code> function definition, the next line retrieves the secret token from the Repl. It uses the <code>os</code> library to access the system&apos;s environment variables (the <code>environ</code> object), and then finds the <code>&quot;DISCORD_BOT_SECRET&quot;</code> value - this is the one set in the <strong>Secrets</strong> for the project.</p>
<pre><code class="lang-py">token = os.environ[<span class="hljs-string">&quot;DISCORD_BOT_SECRET&quot;</span>]
</code></pre>
<h3 id="run">Run!</h3>
<p>After all the setup, the last line actually runs the client using the secret token to log in!</p>
<pre><code class="lang-py">client.run(token)
</code></pre>
<h2 id="part-3-updating-the-bot-code">Part 3: Updating the Bot Code</h2>
<p>The bot code does quite a bit, but it could do quite a bit more. Update it so that it responds to more messages!</p>
<h3 id="prompts--responses-refactoring">Prompts &amp; Responses: Refactoring</h3>
<p>You could add more hard-coded <code>if</code> statements to make the chat bot more responsive, but what if it needs to respond to hundreds of phrases? Or what if you need to add more prompts and responses on-the-fly? Dictionaries can solve this problem! Add a dictionary with prompts as keys and responses as values to lay the groundwork for a more functional chat bot.</p>
<ol>
<li>At the top of the <strong>main.py</strong> file, right after the line that creates the <code>client</code> variable, create a new variable called <code>responses</code></li>
<li>Set <code>responses</code> to a new dictionary <code>{}</code></li>
<li>Add a key of <code>&quot;ping&quot;</code> with a value of <code>&quot;pong&quot;</code></li>
</ol>
<pre><code class="lang-py">responses = {
  <span class="hljs-string">&quot;ping&quot;</span>: <span class="hljs-string">&quot;pong&quot;</span>
}
</code></pre>
<h3 id="checking-for-the-prompt">Checking for the Prompt</h3>
<p>Now, the <code>responses</code> dictionary can be used by the <code>on_message</code> event handler. By using the <code>in</code> keyword, it will be simple to check if the user has sent a message that matches one of the keys from the dictionary.</p>
<ol>
<li>Find the bottom of the <code>on_message</code> function</li>
<li>Find the <code>if message.content == &quot;ping&quot;</code> statement</li>
<li>Instead of checking if <code>content</code> is <code>&quot;ping&quot;</code>, check if it is <code>in</code> the <code>responses</code> dict</li>
<li>In the body of the <code>if</code>, remove the <code>&quot;pong&quot;</code></li>
<li>Replace it with the proper response: the value of the <code>responses</code> dict for a key of <code>message.content</code></li>
</ol>
<p>The updated <code>if</code> statement should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-keyword">if</span> message.content <span class="hljs-keyword">in</span> responses:
  <span class="hljs-keyword">await</span> message.channel.send(responses[message.content])
</code></pre>
<p>Re-run the project, and make sure the &quot;ping&quot; message still receives the &quot;pong&quot; response!</p>
<h3 id="adding-more-promptresponse-pairs">Adding More Prompt/Response Pairs</h3>
<p>The next step is to simply fill out the <code>responses</code> dictionary object with more responses! Keep it mind that it is possible to use emoji like <code>:smile:</code>. You can use whatever (appropriate) prompts and responses you want, but make sure to add <strong>at least three more</strong>.</p>
<p>Your <code>responses</code> object could end up looking something like this:</p>
<pre><code class="lang-py">responses = {
  <span class="hljs-string">&quot;ping&quot;</span>: <span class="hljs-string">&quot;pong&quot;</span>,
  <span class="hljs-string">&quot;hi&quot;</span>: <span class="hljs-string">&quot;howdy :cowboy:&quot;</span>,
  <span class="hljs-string">&quot;sup&quot;</span>: <span class="hljs-string">&quot;yo :sunglasses:&quot;</span>,
  <span class="hljs-string">&quot;how are you?&quot;</span>: <span class="hljs-string">&quot;i am incapable of emotion :no_mouth:&quot;</span>
}
</code></pre>
<h3 id="testing-the-bot-again">Testing the Bot (Again)</h3>
<p>You can test your bot by writing messages that match your prompts. Make sure to post in your specific channel so it doesn&apos;t get too annoying. If your bot shows as offline, it&apos;s possible that your Repl has timed out - if that&apos;s the case you may need to refresh your Repl and re-run it. Your bot should then show up as online again.</p>
<h2 id="conclusion">Conclusion</h2>
<p>By the end of this activity, you should have been able to create a fun and functional conversational bot. The code should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-comment"># import libraries to use</span>
<span class="hljs-keyword">import</span> discord
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># setup bot intents - allow to read messages</span>
intents = discord.Intents.default()
intents.message_content = <span class="hljs-keyword">True</span>

<span class="hljs-comment"># create client with intents</span>
client = discord.Client(intents=intents)

<span class="hljs-comment"># dictionary of responses</span>
responses = {
  <span class="hljs-string">&quot;ping&quot;</span>: <span class="hljs-string">&quot;pong&quot;</span>,
  <span class="hljs-string">&quot;hi&quot;</span>: <span class="hljs-string">&quot;howdy :cowboy:&quot;</span>,
  <span class="hljs-string">&quot;sup&quot;</span>: <span class="hljs-string">&quot;yo :sunglasses:&quot;</span>,
  <span class="hljs-string">&quot;how are you?&quot;</span>: <span class="hljs-string">&quot;i am incapable of emotion :no_mouth:&quot;</span>
}

<span class="hljs-comment"># print message when client is online</span>
<span class="hljs-meta">@client.event</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_ready</span><span class="hljs-params">()</span>:</span>
  print(f<span class="hljs-string">&quot;Logged in as: {client.user}&quot;</span>)

<span class="hljs-comment"># respond to incoming messages</span>
<span class="hljs-meta">@client.event</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">on_message</span><span class="hljs-params">(message)</span>:</span>
  <span class="hljs-comment"># don&apos;t do anything if the message comes from a bot</span>
  <span class="hljs-keyword">if</span> message.author.bot:
    <span class="hljs-keyword">return</span>

  <span class="hljs-comment"># print the incoming message</span>
  print(f<span class="hljs-string">&quot;Message from {message.author}: {message.content}&quot;</span>)

  <span class="hljs-comment"># send a response to a particular message</span>
  <span class="hljs-keyword">if</span> message.content <span class="hljs-keyword">in</span> responses:
    <span class="hljs-keyword">await</span> message.channel.send(responses[message.content])

<span class="hljs-comment"># get token from secret</span>
token = os.environ[<span class="hljs-string">&quot;DISCORD_BOT_SECRET&quot;</span>]

<span class="hljs-comment"># run the bot!</span>
client.run(token)
</code></pre>
<p>Remember, the code won&apos;t work unless you have the bot application setup in Discord, and have the proper token stored in the Repl&apos;s Secrets.</p>
<h2 id="next-steps">Next Steps</h2>
<p>The actual Discord setup may have been tedious and challenging, but now that that&apos;s out of the way, you should feel empowered to create any type of bot you would like! This lesson only scratches the surface of what&apos;s possible with the Discord API and the discord.py library.</p>
<p>Feel free to continue working on your bot as you see fit, or check out the <a href="DiscordChallenges.html">challenges</a> for some ideas.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="StudentDesc.html" class="navigation navigation-prev " aria-label="Previous page: Week 4 - Discord Bot">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="DiscordChallenges.html" class="navigation navigation-next " aria-label="Next page: Discord Challenges">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Discord Code-Along","level":"1.6.1","depth":2,"next":{"title":"Discord Challenges","level":"1.6.2","depth":2,"path":"DiscordBot/DiscordChallenges.md","ref":"DiscordBot/DiscordChallenges.md","articles":[]},"previous":{"title":"Week 4 - Discord Bot","level":"1.6","depth":1,"path":"DiscordBot/StudentDesc.md","ref":"DiscordBot/StudentDesc.md","articles":[{"title":"Discord Code-Along","level":"1.6.1","depth":2,"path":"DiscordBot/DiscordCodeAlong.md","ref":"DiscordBot/DiscordCodeAlong.md","articles":[]},{"title":"Discord Challenges","level":"1.6.2","depth":2,"path":"DiscordBot/DiscordChallenges.md","ref":"DiscordBot/DiscordChallenges.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["toggle-chapters","scripts"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"scripts":{"files":["./passwordProtectedPages.js"]},"toggle-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"BOOKREADME.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Python 201","gitbook":"*"},"file":{"path":"DiscordBot/DiscordCodeAlong.md","mtime":"2023-03-20T12:04:13.389Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-03-20T12:04:47.876Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-scripts/5b9fffafe13ac3cee5d3880ce8c56b27-passwordProtectedPages.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

