
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Restaurant Review Code-Along Â· Python 201</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="DatabaseChallenges.html" />
    
    
    <link rel="prev" href="StudentDesc.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Python 201
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://hylandtechclub.com/ReplitSetup">
            
                    
                    Repl Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../HelloPython/StudentDesc.html">
            
                <a href="../HelloPython/StudentDesc.html">
            
                    
                    Week 1 - Hello Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../HelloPython/TurtleCodeAlong.html">
            
                <a href="../HelloPython/TurtleCodeAlong.html">
            
                    
                    Turtle Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../HelloPython/TurtleChallenges.html">
            
                <a href="../HelloPython/TurtleChallenges.html">
            
                    
                    Turtle Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../BasicProgramming/StudentDesc.html">
            
                <a href="../BasicProgramming/StudentDesc.html">
            
                    
                    Week 2 - Basic Programming
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../BasicProgramming/RPSCodeAlong.html">
            
                <a href="../BasicProgramming/RPSCodeAlong.html">
            
                    
                    Rock Paper Scissors Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../BasicProgramming/RPSChallenges.html">
            
                <a href="../BasicProgramming/RPSChallenges.html">
            
                    
                    Rock Paper Scissors Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Collections/StudentDesc.html">
            
                <a href="../Collections/StudentDesc.html">
            
                    
                    Week 3 - Collections
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Collections/PlaylistWarmup.html">
            
                <a href="../Collections/PlaylistWarmup.html">
            
                    
                    Playlist Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../Collections/ScoreSortCodeAlong.html">
            
                <a href="../Collections/ScoreSortCodeAlong.html">
            
                    
                    Sort By Score Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../Collections/ScoreSortChallenges.html">
            
                <a href="../Collections/ScoreSortChallenges.html">
            
                    
                    Sort By Score Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../DiscordBot/StudentDesc.html">
            
                <a href="../DiscordBot/StudentDesc.html">
            
                    
                    Week 4 - Discord Bot
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../DiscordBot/DiscordCodeAlong.html">
            
                <a href="../DiscordBot/DiscordCodeAlong.html">
            
                    
                    Discord Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../DiscordBot/DiscordChallenges.html">
            
                <a href="../DiscordBot/DiscordChallenges.html">
            
                    
                    Discord Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../WebScraping/StudentDesc.html">
            
                <a href="../WebScraping/StudentDesc.html">
            
                    
                    Week 5 - Web Scraping
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../WebScraping/HtmlReviewWarmup.html">
            
                <a href="../WebScraping/HtmlReviewWarmup.html">
            
                    
                    HTML Review Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../WebScraping/InfoFinderCodeAlong.html">
            
                <a href="../WebScraping/InfoFinderCodeAlong.html">
            
                    
                    Info Finder Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../WebScraping/InfoFinderChallenges.html">
            
                <a href="../WebScraping/InfoFinderChallenges.html">
            
                    
                    Info Finder Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../MidSemesterReview/StudentDesc.html">
            
                <a href="../MidSemesterReview/StudentDesc.html">
            
                    
                    Week 6 - Review + Check-Ins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../MidSemesterReview/Challenges.html">
            
                <a href="../MidSemesterReview/Challenges.html">
            
                    
                    Challenges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../MidSemesterReview/Library.html">
            
                <a href="../MidSemesterReview/Library.html">
            
                    
                    Library
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../Flask/StudentDesc.html">
            
                <a href="../Flask/StudentDesc.html">
            
                    
                    Week 7 - Flask Web Server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../Flask/FlaskBasics.html">
            
                <a href="../Flask/FlaskBasics.html">
            
                    
                    Flask Basics Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../Flask/FlaskCodeAlong.html">
            
                <a href="../Flask/FlaskCodeAlong.html">
            
                    
                    Random Joke Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../Flask/FlaskChallenges.html">
            
                <a href="../Flask/FlaskChallenges.html">
            
                    
                    Flask Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../PyGame/StudentDesc.html">
            
                <a href="../PyGame/StudentDesc.html">
            
                    
                    Week 8 - Pygame
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../PyGame/PygameWarmup.html">
            
                <a href="../PyGame/PygameWarmup.html">
            
                    
                    Pygame Warm-up
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../PyGame/TopDownCodeAlong.html">
            
                <a href="../PyGame/TopDownCodeAlong.html">
            
                    
                    Top-down Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../PyGame/PygameChallenges.html">
            
                <a href="../PyGame/PygameChallenges.html">
            
                    
                    Pygame Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="StudentDesc.html">
            
                <a href="StudentDesc.html">
            
                    
                    Week 9 - Database
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.11.1" data-path="RestaurantReviewCodeAlong.html">
            
                <a href="RestaurantReviewCodeAlong.html">
            
                    
                    Restaurant Review Code-Along
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="DatabaseChallenges.html">
            
                <a href="DatabaseChallenges.html">
            
                    
                    Database Challenges
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../FinalProject/StudentDesc.html">
            
                <a href="../FinalProject/StudentDesc.html">
            
                    
                    Week 10 - Final Project
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Restaurant Review Code-Along</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="restaurant-review-code-along">Restaurant Review Code-Along</h1>
<p>In this activity, use <a href="https://docs.replit.com/hosting/databases/replit-database" target="_blank">Replit&apos;s Database</a> to create a console-based Restaurant Review application. The most interesting part of this program will be that the data stored in the application will persist across runs.</p>
<h2 id="getting-started">Getting Started</h2>
<p>There is a starter version of the app, but it is really just the facade with no functionality. It has all the &quot;user interface&quot; without the actual data; a <code>while</code> loop menu, and functions to retrieve information from the user and presumably create, read, update, and delete reviews. All that&apos;s missing is the actual database.</p>
<ol>
<li>Go to the <a href="https://replit.com/@HylandOutreach/FakeYelpStart" target="_blank">starter Repl project</a></li>
<li>Click the &quot;Fork&quot; button to fork it</li>
<li>Run the application to see how it currently works</li>
</ol>
<h2 id="a-reviews-module">A <code>reviews</code> Module</h2>
<p>In order to keep things organized, create a separate <a href="https://docs.python.org/3/tutorial/modules.html" target="_blank">module</a> for accessing the database.</p>
<ol>
<li>Create a new file in the Repl project named <strong>reviews.py</strong></li>
<li>Open the <strong>reviews.py</strong> file for editing</li>
<li>In the file, define a new function named <code>clear_all</code> (no parameters)</li>
<li>In the body of the <code>clear_all</code> function, simply put <code>print(&apos;clearing&apos;)</code> for now</li>
</ol>
<h3 id="using-the-module">Using the Module</h3>
<p>Now that the <code>reviews</code> module has been created, it will be possible to use it within the <strong>main.py</strong> file.</p>
<ol>
<li>Open the <strong>main.py</strong> file for editing</li>
<li>At the top of the file, under <code>import os</code>, make a new line</li>
<li>Add the following code to import the <code>reviews</code> module:  <pre><code class="lang-py"> <span class="hljs-keyword">import</span> reviews
</code></pre>
</li>
<li>Find the <code>clear_db</code> function definition in the <strong>main.py</strong> file</li>
<li>Find the comment that says <code># Actually delete everything</code></li>
<li>Under that, add the following code to call the <code>clear_all</code> function from the <strong>reviews.py</strong> file:  <pre><code class="lang-py"> reviews.clear_all()
</code></pre>
</li>
<li>Run the program, enter <code>0</code> as the command, and verify that the <code>clear_all</code> function runs</li>
</ol>
<p>Now the <strong>reviews.py</strong> file has successfully been connected to the <strong>main.py</strong> file.</p>
<h2 id="clearing-the-database">Clearing the Database</h2>
<p>One useful tool to employ during the database development process is a way to clear everything out of the database. This can remove any unwanted test data or poorly structured objects, and will help ensure the application works with a fresh environment.</p>
<ol>
<li>At the top of the <strong>reviews.py</strong> file, add the code below to import the <code>replit.db</code> module:  <pre><code class="lang-py"> <span class="hljs-keyword">from</span> replit <span class="hljs-keyword">import</span> db
</code></pre>
</li>
<li>Find the <code>clear_all</code> function definition</li>
<li>In the body of the function, remove the <code>print</code> and create a <code>for</code> loop</li>
<li>For the <code>for</code> loop item variable, use <code>key</code></li>
<li>For the <code>for</code> loop collection, use <code>db.keys()</code>  <ul>
<li>This retrieves a collection of every single key in the DB</li>
</ul>
</li>
<li>In the body of the <code>for</code> loop, add the following code to delete the object at the current key:  <pre><code class="lang-py"> <span class="hljs-keyword">del</span> db[key]
</code></pre>
</li>
</ol>
<p>The code in the <strong>reviews.py</strong> file should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-keyword">from</span> replit <span class="hljs-keyword">import</span> db

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clear_all</span><span class="hljs-params">()</span>:</span>
  <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> db.keys():
    <span class="hljs-keyword">del</span> db[key]
</code></pre>
<p>There is currently no way to test this, because there is no way to add anything to the database! That will come later - next, it&apos;s time to think about the architecture of the database.</p>
<h2 id="architecture">Architecture</h2>
<p>Before diving into the CRUD implementation, take a moment to consider the format of the data.</p>
<h3 id="review-objects">Review Objects</h3>
<p>Each <strong>Review</strong> object should have each of the following properties:</p>
<ul>
<li>The name of the restaurant</li>
<li>A score for the  review</li>
<li>The text for the review</li>
</ul>
<p>Each review can be stored in a dictionary with keys for each property. For example:</p>
<pre><code class="lang-py">review = {
    <span class="hljs-string">&apos;restaurant&apos;</span>: <span class="hljs-string">&apos;Chipotle&apos;</span>,
    <span class="hljs-string">&apos;score&apos;</span>: <span class="hljs-number">8</span>,
    <span class="hljs-string">&apos;text&apos;</span>: <span class="hljs-string">&apos;I ordered a burrito with only guacamole in it and it was delicious&apos;</span>
}
</code></pre>
<p>Those dictionaries would then be stored within the Replit database.</p>
<h3 id="keys">Keys</h3>
<p>Because the Replit database uses a simple key-value store, different types of data can be represented with <em>prefixes</em>. For example, each review object stored in the database could have a key that begins with <code>review_</code>. That way, it would be possible to find all review keys using <code>db.prefix</code>:</p>
<pre><code class="lang-py">review_keys = db.prefix(<span class="hljs-string">&quot;review_&quot;</span>)
<span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> review_keys:
    review = db[key]
    <span class="hljs-comment"># do something with `review`</span>
</code></pre>
<p>Each key must be unique, so the code needs a way to generate a different key for each new review.</p>
<h3 id="review-id">Review ID</h3>
<p>Review objects should be identifiable based on an ID. Rather than having the user come up with this ID, the code can <em>auto-increment</em> a numeric ID value.</p>
<p>The current value of the ID can be stored in the database with a key of <code>&apos;next-id&apos;</code>. For example, it could look like this.</p>
<p><strong>db</strong></p>
<pre><code class="lang-py">{
    <span class="hljs-string">&apos;next-id&apos;</span>: <span class="hljs-number">0</span>
}
</code></pre>
<p>Then, when a new review is created, it would increment:</p>
<p><strong>db</strong></p>
<pre><code class="lang-py">{
    <span class="hljs-string">&apos;next-id&apos;</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">&apos;review_0&apos;</span>: {
        <span class="hljs-string">&apos;restaurant&apos;</span>: <span class="hljs-string">&apos;Burger King&apos;</span>,
        <span class="hljs-string">&apos;score&apos;</span>: <span class="hljs-number">10</span>,
        <span class="hljs-string">&apos;text&apos;</span>: <span class="hljs-string">&apos;I love the burger king&apos;</span>
    }
}
</code></pre>
<p>And so on:</p>
<p><strong>db</strong></p>
<pre><code class="lang-py">{
    <span class="hljs-string">&apos;next-id&apos;</span>: <span class="hljs-number">2</span>,
    <span class="hljs-string">&apos;review_0&apos;</span>: {
        <span class="hljs-string">&apos;restaurant&apos;</span>: <span class="hljs-string">&apos;Burger King&apos;</span>,
        <span class="hljs-string">&apos;score&apos;</span>: <span class="hljs-number">10</span>,
        <span class="hljs-string">&apos;text&apos;</span>: <span class="hljs-string">&apos;I love the burger king&apos;</span>
    },
    <span class="hljs-string">&apos;review_1&apos;</span>: {
        <span class="hljs-string">&apos;restaurant&apos;</span>: <span class="hljs-string">&apos;The Cheesecake Factory&apos;</span>,
        <span class="hljs-string">&apos;score&apos;</span>: <span class="hljs-number">4</span>,
        <span class="hljs-string">&apos;text&apos;</span>: <span class="hljs-string">&apos;I ate too much cheesecake&apos;</span>
    }
}
</code></pre>
<p>From there, if a user of the database wanted to access a review, all they would need is the numeric id. They could then create the db key based on that value.</p>
<pre><code class="lang-py">numeric_id = <span class="hljs-number">1</span>
db_key = <span class="hljs-string">&apos;review_{0}&apos;</span>.format(numeric_id)
review_1 = db[db_key]
</code></pre>
<p>Now that the structure of the database has been determined, it&apos;s time to start using it.</p>
<h2 id="create-adding-a-review">[CREATE] Adding a Review</h2>
<p>The first thing to do when working with the Replit database is add some data to it! Create a function that can add a new review to the database. The function should take in the various <strong>Review</strong> object properties as parameters. It should generate a new ID, increment the next ID, create a db key, create the dictionary object, and add the object to the db with the key.</p>
<h3 id="function-definition---setup">Function Definition - Setup</h3>
<p>Start with the stubbed out form of the function definition.</p>
<ol>
<li>Open the <strong>reviews.py</strong> file for editing</li>
<li>Under the <code>clear_all</code> function definition, make a new line</li>
<li>Define a new function named <code>add_review</code>  <ul>
<li>It should take three parameters: <code>restaurant</code>, <code>score</code>, and <code>text</code></li>
</ul>
</li>
</ol>
<p>The function should look something like this so far:</p>
<pre><code class="lang-py"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_review</span><span class="hljs-params">(restaurant, score, text)</span>:</span>
</code></pre>
<h3 id="function-definition---getting-the-id">Function Definition - Getting the ID</h3>
<p>Next, the function should generate an ID for the new <strong>Review</strong> object. The trick here is that the database <em>might</em> have an auto-incremented ID already running, but it might not. If it does, the next ID should be retrieved from the database. If it does not, the ID should be <code>0</code>.</p>
<ol>
<li>In the body of the <code>add_review</code> function, declare a variable named <code>id_for_new_review</code></li>
<li>Set the <code>id_for_new_review</code> variable to <code>0</code></li>
<li>Under that, create an <code>if</code> statement</li>
<li>For the <code>if</code> condition, check if <code>&apos;next_id&apos;</code> is in <code>db.keys()</code>  <ul>
<li>This will tell the code if there is already a <code>next_id</code> value</li>
</ul>
</li>
<li>In the body of the <code>if</code>, set the <code>id_for_new_review</code> variable to <code>db[&apos;next_id&apos;]</code>  <ul>
<li>This will grab the <code>next_id</code> value from the database</li>
</ul>
</li>
<li>Outside of the <code>if</code> statement, set the <code>next_id</code> value in the database to <code>id_for_new_review + 1</code>  <ul>
<li>This is the <em>auto-increment</em> that occurs with each new object</li>
</ul>
</li>
</ol>
<p>The code for this part should look something like this:</p>
<pre><code class="lang-py">id_for_new_review = <span class="hljs-number">0</span>

<span class="hljs-keyword">if</span> <span class="hljs-string">&apos;next_id&apos;</span> <span class="hljs-keyword">in</span> db.keys():
  id_for_new_review = db[<span class="hljs-string">&apos;next_id&apos;</span>]

db[<span class="hljs-string">&apos;next_id&apos;</span>] = id_for_new_review + <span class="hljs-number">1</span>
</code></pre>
<h3 id="function-definition---adding-the-review-object">Function Definition - Adding the Review Object</h3>
<p>Now that an ID has been generated, the review can be added. First, create the db key based on the ID. Then, add a new dictionary to the db with the proper values, using the created key.</p>
<ol>
<li>Still in the body of the <code>add_review</code> function, make a new line</li>
<li>Create a variable named <code>new_db_key</code></li>
<li>Set <code>new_db_key</code> to equal <code>&apos;review_{0}&apos;.format(id_for_new_review)</code>  <ul>
<li>This will append the new ID to the <code>&apos;review_&apos;</code> prefix for the key</li>
</ul>
</li>
<li>Under that, set the <code>db[new_db_key]</code> value  <ul>
<li>It should be a new dictionary with <code>restaurant</code>, <code>score</code>, and <code>text</code> properties</li>
</ul>
</li>
</ol>
<p>The code for this part should look something like this:</p>
<pre><code class="lang-py">new_db_key = <span class="hljs-string">&apos;review_{0}&apos;</span>.format(id_for_new_review)

db[new_db_key] = {
  <span class="hljs-string">&apos;restaurant&apos;</span>: restaurant,
  <span class="hljs-string">&apos;score&apos;</span>: score,
  <span class="hljs-string">&apos;text&apos;</span>: text
}
</code></pre>
<h3 id="calling-the-function">Calling the Function</h3>
<p>Now that the <code>add_review</code> function has been defined, it must be called appropriately.</p>
<ol>
<li>Open the <strong>main.py</strong> file for editing</li>
<li>Find the <code>prompt_for_add_review</code> function</li>
<li>In the body of that function, find the comment that says <code># Actually add the review</code></li>
<li>Under that, call the <code>reviews.add_review</code> function</li>
<li>Pass in <code>restaurant</code>, <code>score</code>, and <code>text</code> as the arguments</li>
<li>Run the program, and verify that it is possible to add a review to the DB!</li>
</ol>
<p>The code should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-comment"># Actually add the review</span>
reviews.add_review(restaurant, score, text)
</code></pre>
<h3 id="testing">Testing</h3>
<p>After adding a review, refresh the page, and go to the Database tab in the Repl. There should be 2 keys in the DB now:</p>
<p><img src="https://i.imgur.com/7HlRkVi.png" alt=""></p>
<p>While that verifies that <em>something</em> was added to the database, the real way to test this code is by <em>reading</em> from the database. That comes next!</p>
<h2 id="read-getting-reviews">[READ] Getting Reviews</h2>
<p>Now that the database presumably has a review to read, it&apos;s time to fill out the &quot;View Reviews&quot; functionality. Define a function that will loop through each review key, grab each review object, and return a list of all of them (including their respective IDs).</p>
<h3 id="function-definition---setup">Function Definition - Setup</h3>
<p>Start with the basic function definition setup.</p>
<ol>
<li>Open the <strong>reviews.py</strong> file for editing</li>
<li>At the bottom of the file, under the <code>add_review</code> function definition, make some space  </li>
<li>Define a new function named <code>get_reviews</code><ul>
<li>It should take no parameters</li>
</ul>
</li>
<li>In the body of the <code>get_reviews</code> function, create a new variable named <code>all_reviews</code></li>
<li>Set <code>all_reviews</code> to a new empty list (<code>[]</code>)</li>
</ol>
<p>The code so far should look like this:</p>
<pre><code class="lang-py"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_reviews</span><span class="hljs-params">()</span>:</span>
  all_reviews = []
</code></pre>
<h3 id="function-definition---for-loop">Function Definition - For Loop</h3>
<p>Next, loop through the reviews and add them to the list.</p>
<ol>
<li>Under the <code>all_reviews</code> variable, still in the <code>get_reviews</code> body, create a <code>for</code> loop</li>
<li>For the <code>for</code> loop item name, use <code>key</code></li>
<li>For the <code>for</code> loop collection, use <code>db.prefix(&apos;review_&apos;)</code>  <ul>
<li>This will retrieve all keys in the DB that begin with <code>review_</code></li>
</ul>
</li>
<li>In the body of the <code>for</code> loop, create a variable named <code>review_dict</code></li>
<li>Set <code>review_dict</code> to <code>db[key]</code><ul>
<li>This will grab the object with the current key</li>
</ul>
</li>
<li>On the next line in the <code>for</code> loop body, reference the <code>&apos;id&apos;</code> key of <code>review_dict</code></li>
<li>Set it equal to <code>key.replace(&apos;review_&apos;, &apos;&apos;)</code><ul>
<li>This will be the ID by itself, without the <code>review_</code> prefix</li>
</ul>
</li>
<li>On the next line in the <code>for</code> loop body, <code>append</code> the <code>review_dict</code> to the <code>all_reviews</code> list</li>
</ol>
<p>The <code>for</code> loop code should look like this:</p>
<pre><code class="lang-py"><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> db.prefix(<span class="hljs-string">&apos;review_&apos;</span>):
  review_dict = db[key]
  review_dict[<span class="hljs-string">&apos;id&apos;</span>] = key.replace(<span class="hljs-string">&apos;review_&apos;</span>, <span class="hljs-string">&apos;&apos;</span>)
  all_reviews.append(review_dict)
</code></pre>
<h3 id="function-definition---return">Function Definition - Return</h3>
<p>For the last part of the <code>get_reviews</code> definition, return the list. At the bottom of the <code>get_reviews</code> body (outside of the <code>for</code> loop), add <code>return all_reviews</code>.</p>
<p>The code for the function should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_reviews</span><span class="hljs-params">()</span>:</span>
  all_reviews = []
  <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> db.prefix(<span class="hljs-string">&apos;review_&apos;</span>):
    review_dict = db[key]
    review_dict[<span class="hljs-string">&apos;id&apos;</span>] = key.replace(<span class="hljs-string">&apos;review_&apos;</span>, <span class="hljs-string">&apos;&apos;</span>)
    all_reviews.append(review_dict)

  <span class="hljs-keyword">return</span> all_reviews
</code></pre>
<h3 id="calling-the-function">Calling the Function</h3>
<p>Now that the function is ready, it must be called properly.</p>
<ol>
<li>Open the <strong>main.py</strong> file for editing</li>
<li>Find the <code>print_reviews</code> function definition</li>
<li>In the body of <code>print_reviews</code>, find the comment that says <code># Actually get the reviews</code></li>
<li>Under that, replace the <code>[]</code> with a call to the <code>reviews.get_reviews</code> function</li>
<li>Run the code, and verify that it is possible to view any added reviews with the proper information!</li>
</ol>
<p>The code to call the function should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-comment"># Actually get the reviews</span>
review_list = reviews.get_reviews()
</code></pre>
<p>At this point, the app is actually fairly functional! It should be possible to add and view reviews. The next two parts complete the CRUD functionality - <strong>U</strong>pdating and <strong>D</strong>eleting.</p>
<h2 id="update-updating-a-review">[UPDATE] Updating a Review</h2>
<p>On a return visit to a previously reviewed restaurant, a user of the app may decide that they have a different opinion than their original review expressed. In this case, it would be nice if they could update their review. This will be possible because each review has a unique ID, and the database entry for a review can be updated based on new information.</p>
<p>Define a function to update a review. It should take in a review ID, a new score, and new review text. It should grab the proper review from the database (based on the ID provided). If the ID is invalid, the function should return false. Otherwise, it should re-set the database object with the new values, and return true.</p>
<h3 id="function-definition---setup">Function Definition - Setup</h3>
<p>First, create the stub for the function.</p>
<ol>
<li>Open the <strong>reviews.py</strong> file for editing</li>
<li>Make some space at the bottom of the file</li>
<li>There, define a new function named <code>update_review</code>  <ul>
<li>It should take three parameters: <code>review_id</code>, <code>score</code>, and <code>text</code></li>
</ul>
</li>
</ol>
<p>The function should look something like this so far:</p>
<pre><code class="lang-py"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_review</span><span class="hljs-params">(review_id, score, text)</span>:</span>
</code></pre>
<h3 id="function-definition---getting-the-review-key">Function Definition - Getting the Review Key</h3>
<p>Next, make the function actually do something. The first thing to do is grab the existing review based on the <code>review_id</code> parameter.</p>
<ol>
<li>In the body of the <code>update_review</code> function, create a variable named <code>update_db_key</code></li>
<li>Set <code>update_db_key</code> to <code>&apos;review_&apos; + review_id</code><ul>
<li>This will be the key for the review with the given ID</li>
</ul>
</li>
<li>Under that, still in the <code>update_review</code> body, create an <code>if</code> statement</li>
<li>For the <code>if</code> condition, check if <code>update_db_key not in db.keys()</code>  <ul>
<li>This would mean a review with that ID does not exist</li>
</ul>
</li>
<li>In the body of the <code>if</code>, return <code>False</code><ul>
<li>This indicates that the update failed</li>
</ul>
</li>
<li>Outside of the <code>if</code> statement body, on the next line, create a new variable named <code>update_review</code></li>
<li>Set <code>update_review</code> to <code>db[update_db_key]</code><ul>
<li>This will hold the review object the user wants to update</li>
</ul>
</li>
</ol>
<p>The code for this part should look something like this:</p>
<pre><code class="lang-py">update_db_key = <span class="hljs-string">&apos;review_&apos;</span> + review_id
<span class="hljs-keyword">if</span> update_db_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> db.keys():
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">False</span>

update_review = db[update_db_key]
</code></pre>
<h3 id="function-definition---setting-the-new-review">Function Definition - Setting the New Review</h3>
<p>Now that the review has been retrieved from the database, it&apos;s time to update it. Set the object values based on the parameters, and then set the db value.</p>
<ol>
<li>On the next line, set the <code>&apos;score&apos;</code> of <code>update_review</code> to <code>score</code></li>
<li>Under that, set the <code>&apos;text&apos;</code> of <code>&apos;update_review&apos;</code> to <code>text</code></li>
<li>Next, set <code>db[update_db_key]</code> to <code>update_review</code><ul>
<li>This updates the value in the database</li>
</ul>
</li>
<li>Finish out the function by returning <code>True</code></li>
</ol>
<p>The code for the function should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_review</span><span class="hljs-params">(review_id, score, text)</span>:</span>
  update_db_key = <span class="hljs-string">&apos;review_&apos;</span> + review_id
  <span class="hljs-keyword">if</span> update_db_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> db.keys():
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">False</span>

  update_review = db[update_db_key]
  update_review[<span class="hljs-string">&apos;score&apos;</span>] = score
  update_review[<span class="hljs-string">&apos;text&apos;</span>] = text

  db[update_db_key] = update_review
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">True</span>
</code></pre>
<h3 id="calling-the-function">Calling the Function</h3>
<p>All that&apos;s left for updating is calling the function in the proper place.</p>
<ol>
<li>Open the <strong>main.py</strong> file for editing</li>
<li>Find the <code>prompt_for_update_review</code> function definition</li>
<li>In the body of <code>prompt_for_update_review</code>, find the comment that says <code># Actually update the review</code></li>
<li>Under that, replace the <code>False</code> with a call to the <code>reviews.update_review</code> function  <ul>
<li>Pass in the <code>update_id</code>, <code>score</code>, and <code>text</code></li>
</ul>
</li>
<li>Run the code, and verify that it is possible to update an existing review!</li>
</ol>
<p>The code to call the function should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-comment"># Actually update the review</span>
success = reviews.update_review(update_id, score, text)
</code></pre>
<p>At this point, there is only one part of CRUD remaining: <strong>D</strong>elete.</p>
<h2 id="delete-deleting-a-review">[DELETE] Deleting a Review</h2>
<p>If a user wants to delete a review, they should be able to provide the ID and the program should delete the review from the database.</p>
<h3 id="function-definition">Function Definition</h3>
<p>The function for deleting a review will be quite similar to the <code>update_review</code> function.</p>
<ol>
<li>Open the <strong>reviews.py</strong> file for editing</li>
<li>At the bottom, define a new function named <code>delete_review</code><ul>
<li>This should take in <code>review_id</code> as a parameter</li>
</ul>
</li>
<li>In the body of the function, make a new variable named <code>delete_db_key</code></li>
<li>Set <code>delete_db_key</code> to <code>&apos;review_&apos; + review_id</code></li>
<li>On the next line, create an <code>if</code> statement checking if the key is NOT in the database<ul>
<li>This is similar to the <code>update_review</code> function</li>
</ul>
</li>
<li>In the body of the <code>if</code>, return <code>False</code> to indicate failure</li>
<li>Under that, use <code>del db[delete_db_key]</code> to delete the value from the database</li>
<li>Under <em>that</em>, return <code>True</code> to indicate success</li>
</ol>
<p>The code should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_review</span><span class="hljs-params">(review_id)</span>:</span>
  delete_db_key = <span class="hljs-string">&apos;review_&apos;</span> + review_id
  <span class="hljs-keyword">if</span> delete_db_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> db.keys():
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">False</span>

  <span class="hljs-keyword">del</span> db[delete_db_key]
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">True</span>
</code></pre>
<h3 id="calling-the-function">Calling the Function</h3>
<p>Now all that&apos;s left is calling the <code>delete_review</code> function.</p>
<ol>
<li>Open the <strong>main.py</strong> file for editing</li>
<li>Find the <code>prompt_for_delete_review</code> function</li>
<li>In the body of that function, find the comment that says <code># Actually delete the review</code></li>
<li>Under that, replace the <code>False</code> with a call to <code>reviews.delete_review</code><ul>
<li>Pass in <code>review_id</code> as an argument</li>
</ul>
</li>
<li>Run the code, and verify that it is possible to delete a review!</li>
</ol>
<p>The code to call the function should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-comment"># Actually delete the review</span>
success = reviews.delete_review(delete_id)
</code></pre>
<p>And that&apos;s it! Now the app has complete CRUD functionality.</p>
<h2 id="final-code---reviewspy-file">Final Code - reviews.py File</h2>
<p>The code in the <strong>reviews.py</strong> file should look something like this:</p>
<pre><code class="lang-py"><span class="hljs-keyword">from</span> replit <span class="hljs-keyword">import</span> db

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clear_all</span><span class="hljs-params">()</span>:</span>
  <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> db.keys():
    <span class="hljs-keyword">del</span> db[key]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_review</span><span class="hljs-params">(restaurant, score, text)</span>:</span>
  id_for_new_review = <span class="hljs-number">0</span>

  <span class="hljs-keyword">if</span> <span class="hljs-string">&apos;next_id&apos;</span> <span class="hljs-keyword">in</span> db.keys():
    id_for_new_review = db[<span class="hljs-string">&apos;next_id&apos;</span>]

  db[<span class="hljs-string">&apos;next_id&apos;</span>] = id_for_new_review + <span class="hljs-number">1</span>

  new_db_key = <span class="hljs-string">&apos;review_{0}&apos;</span>.format(id_for_new_review)

  db[new_db_key] = {
    <span class="hljs-string">&apos;restaurant&apos;</span>: restaurant,
    <span class="hljs-string">&apos;score&apos;</span>: score,
    <span class="hljs-string">&apos;text&apos;</span>: text
  }

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_reviews</span><span class="hljs-params">()</span>:</span>
  all_reviews = []
  <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> db.prefix(<span class="hljs-string">&apos;review_&apos;</span>):
    review_dict = db[key]
    review_dict[<span class="hljs-string">&apos;id&apos;</span>] = key.replace(<span class="hljs-string">&apos;review_&apos;</span>, <span class="hljs-string">&apos;&apos;</span>)
    all_reviews.append(review_dict)

  <span class="hljs-keyword">return</span> all_reviews

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update_review</span><span class="hljs-params">(review_id, score, text)</span>:</span>
  update_db_key = <span class="hljs-string">&apos;review_&apos;</span> + review_id
  <span class="hljs-keyword">if</span> update_db_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> db.keys():
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">False</span>

  update_review = db[update_db_key]
  update_review[<span class="hljs-string">&apos;score&apos;</span>] = score
  update_review[<span class="hljs-string">&apos;text&apos;</span>] = text

  db[update_db_key] = update_review
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">True</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_review</span><span class="hljs-params">(review_id)</span>:</span>
  delete_db_key = <span class="hljs-string">&apos;review_&apos;</span> + review_id
  <span class="hljs-keyword">if</span> delete_db_key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> db.keys():
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">False</span>

  <span class="hljs-keyword">del</span> db[delete_db_key]
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">True</span>
</code></pre>
<h2 id="next-steps">Next Steps</h2>
<p>While this app may be quite simple, it demonstrates some of the key capabilities of the Replit database. Working from these fundamentals, it is possible to build almost anything. Databases can be incorporated into any type of app, be it a web server, a game, a discord bot, or anything else.</p>
<p>Feel free to experiment further with the database functionality. If desired, there are some guided <a href="DatabaseChallenges.html">challenges</a> to complete as well.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="StudentDesc.html" class="navigation navigation-prev " aria-label="Previous page: Week 9 - Database">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="DatabaseChallenges.html" class="navigation navigation-next " aria-label="Next page: Database Challenges">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Restaurant Review Code-Along","level":"1.11.1","depth":2,"next":{"title":"Database Challenges","level":"1.11.2","depth":2,"path":"Database/DatabaseChallenges.md","ref":"Database/DatabaseChallenges.md","articles":[]},"previous":{"title":"Week 9 - Database","level":"1.11","depth":1,"path":"Database/StudentDesc.md","ref":"Database/StudentDesc.md","articles":[{"title":"Restaurant Review Code-Along","level":"1.11.1","depth":2,"path":"Database/RestaurantReviewCodeAlong.md","ref":"Database/RestaurantReviewCodeAlong.md","articles":[]},{"title":"Database Challenges","level":"1.11.2","depth":2,"path":"Database/DatabaseChallenges.md","ref":"Database/DatabaseChallenges.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["toggle-chapters","scripts"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"scripts":{"files":["./passwordProtectedPages.js"]},"toggle-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"BOOKREADME.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Python 201","gitbook":"*"},"file":{"path":"Database/RestaurantReviewCodeAlong.md","mtime":"2023-03-21T19:56:39.443Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-03-21T19:57:21.453Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-scripts/5b9fffafe13ac3cee5d3880ce8c56b27-passwordProtectedPages.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

